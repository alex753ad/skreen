# ═══════════════════════════════════════════════════════════════
# ЕДИНЫЙ КОНФИГ — Mean Reversion Pairs Trading System v27
# ═══════════════════════════════════════════════════════════════
# Все приложения (scanner, monitor, backtester, analysis)
# читают параметры из этого файла.
# Редактируйте ТОЛЬКО здесь — все приложения подхватят.
# ═══════════════════════════════════════════════════════════════

# --- СТРАТЕГИЯ ---
strategy:
  entry_z: 1.8
  exit_z: 0.5
  stop_z_offset: 2.0
  min_stop_z: 4.0
  take_profit_pct: 1.5
  stop_loss_pct: -5.0
  max_hold_hours: 3
  micro_bt_max_bars: 6
  min_hurst: 0.45
  warn_hurst: 0.48
  min_correlation: 0.20
  hr_naked_threshold: 0.15
  max_pvalue: 0.15
  commission_pct: 0.10
  slippage_pct: 0.05

# --- СКАНЕР ---
scanner:
  coins_limit: 100
  timeframe: "4h"
  lookback_days: 50
  exchange: "okx"
  refresh_interval_min: 10

# --- МОНИТОР ---
monitor:
  refresh_interval_sec: 120
  exit_z_target: 0.5
  pnl_stop_pct: -1.2
  trailing_z_bounce: 0.8
  time_warning_ratio: 1.0
  time_exit_ratio: 1.5
  time_critical_ratio: 2.0
  overshoot_deep_z: 1.0
  pnl_trailing_threshold: 0.5
  pnl_trailing_fraction: 0.4
  hurst_critical: 0.50
  hurst_warning: 0.48
  hurst_border: 0.45
  pvalue_warning: 0.10
  correlation_warning: 0.20
  # --- AUTO-EXIT ---
  auto_exit_enabled: true
  auto_tp_pct: 0.8
  auto_sl_pct: -1.2
  auto_exit_z: 0.3
  auto_exit_z_min_pnl: 0.3
  trailing_enabled: true
  trailing_activate_pct: 0.5
  trailing_drawdown_pct: 0.25
  # --- CONFLICT & COOLDOWN ---
  auto_flip_enabled: true
  pair_cooldown_hours: 4
  pair_loss_limit_pct: -2.0
  coin_loss_warn_pct: -3.0
  daily_loss_limit_pct: -5.0
  # --- LIMITS ---
  max_positions: 10
  max_coin_exposure: 4
  entry_grace_minutes: 15

# --- БЭКТЕСТЕР ---
backtester:
  n_bars: 300
  max_bars: 50
  min_bars: 2
  n_folds_wf: 3
  train_pct: 0.65

# --- Z-VELOCITY (R4) ---
z_velocity:
  lookback: 5
  excellent_min_vel: 0.1
  decel_threshold: 0.05

# --- RALLY FILTER ---
rally_filter:
  warning_z: 2.0
  block_z: 2.5
  exit_z: 0.0
  cooldown_bars: 2
